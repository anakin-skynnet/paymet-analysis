# =============================================================================
# Step 2: Simulate payment transaction events (producer)
# =============================================================================
# Serverless compute. Generates synthetic payment events at high volume for
# real-time pipeline testing. Events are ingested by Lakeflow (step 3).
# =============================================================================

resources:
  jobs:
    "job_2_simulate_transaction_events":
      name: "[${var.environment}] 2. Simulate Transaction Events (Producer)"
      description: "Generate synthetic payment events at high volume for real-time pipeline testing. Events will be ingested into the solution by Lakeflow and step 3."
      tasks:
        - task_key: generate_transactions
          description: "Generate synthetic payment events at high volume"
          notebook_task:
            notebook_path: ${workspace.root_path}/src/payment_analysis/streaming/transaction_simulator
            base_parameters:
              catalog: ${var.catalog}
              schema: ${var.schema}
              events_per_second: "1000"
              duration_minutes: "60"
              output_mode: "delta"
          timeout_seconds: 3600
      tags:
        environment: ${var.environment}
        project: payment-analysis
        component: simulator
        step: "2"
        type: streaming
        domain: payment-analytics
